```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
library(ggbeeswarm)
library(dplyr)
library(data.table)
library(plotly)
theme_set(theme_bw())
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
enem = read_csv(here::here("dados/sem_escolas_privadas/enem.csv"))
enem_privadas = read_csv(here::here("dados/com_escolas_privadas/enem.csv"))
ideb_anos_finais = read_csv(here::here("dados/sem_escolas_privadas/ideb_anos_finais.csv"))
ideb_anos_iniciais = read_csv(here::here("dados/sem_escolas_privadas/ideb_anos_iniciais.csv"))
```

```{r}
enem %>%
    ggplot(aes(x = NU_MEDIA_TOTAL)) +
    geom_histogram(binwidth = 10, color = "#F6511D", fill = "white")
```

```{r}
por_dependencia = enem_privadas %>%
  mutate(Dependência=ifelse(TP_DEPENDENCIA == 4, "Privada", "Pública"))
  
enem_privadas %>%
    ggplot(aes(x = NU_MEDIA_TOTAL)) +
    geom_histogram(binwidth = 10, color = "#F6511D", fill = "white")

vis2 = por_dependencia %>%
  ggplot(aes(y = NU_MEDIA_TOTAL, x = Dependência, color = Dependência, text = paste("Nome:", NO_ESCOLA_x, "<br>Código:", CO_ESCOLA, "<br>Nota:", NU_MEDIA_TOTAL))) + 
  geom_quasirandom(show.legend = FALSE) +
  scale_y_continuous(trans = "sqrt")

ggplotly(vis2, tooltip ="text")
```


```{r}
ideb_anos_finais = ideb_anos_finais %>%
    filter(TP_SITUACAO_FUNCIONAMENTO == 1)

ideb_anos_finais %>%
    ggplot(aes(x = NU_NOTA)) +
    geom_histogram(breaks=seq(0, 10, by = 1),binwidth = 10, color = "#F6511D", fill = "white")

vis2 = ideb_anos_finais %>%
  ggplot(aes(y = NU_NOTA, x = NU_ANO_CENSO, color = "#F6511D", text = paste("Nome:", NO_ESCOLA_x, "<br>Código:", CO_ESCOLA, "<br>Nota:", NU_NOTA))) + 
  geom_quasirandom(show.legend = FALSE) +
  scale_y_continuous(trans = "sqrt")

ggplotly(vis2, tooltip ="text")
```

```{r}
ideb_anos_iniciais = ideb_anos_iniciais %>%
    filter(TP_SITUACAO_FUNCIONAMENTO == 1)

ideb_anos_iniciais %>%
    ggplot(aes(x = NU_NOTA)) +
    geom_histogram(breaks=seq(0, 10, by = 1),binwidth = 10, color = "#F6511D", fill = "white")

vis2 = ideb_anos_iniciais %>%
  ggplot(aes(y = NU_NOTA, x = NU_ANO_CENSO, color = "#F6511D", text = paste("Nome:", NO_ESCOLA_x, "<br>Código:", CO_ESCOLA, "<br>Nota:", NU_NOTA))) + 
  geom_quasirandom(show.legend = FALSE) +
  scale_y_continuous(trans = "sqrt")

ggplotly(vis2, tooltip ="text")
```
